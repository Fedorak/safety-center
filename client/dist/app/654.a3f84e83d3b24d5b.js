"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[654],{2654:(w,h,r)=>{r.r(h),r.d(h,{ProductsModule:()=>l});var g=r(2090),i=r(4780),C=r(297),t=r(8256),f=r(4367);class a{constructor(e,o){this.mongo=e,this.alert=o,this.products=[],this._products={},this.products=e.get("product",{},(n,s)=>{this._products=s})}new(){return{_id:"",name:"",description:"",price:"",characteristics:""}}create(e=this.new(),o=(s=>{}),n="product has been created."){e._id?this.save(e):this.mongo.create("product",e,s=>{o(s),this.alert.show({text:n})})}doc(e){return this._products[e]||(this._products[e]=this.mongo.fetch("product",{query:{_id:e}})),this._products[e]}update(e,o=(s=>{}),n="product has been updated."){this.mongo.afterWhile(e,()=>{this.save(e,o,n)})}save(e,o=(s=>{}),n="product has been updated."){this.mongo.update("product",e,()=>{n&&this.alert.show({text:n,unique:e})})}delete(e,o=(s=>{}),n="product has been deleted."){this.mongo.delete("product",e,()=>{n&&this.alert.show({text:n})})}}a.\u0275fac=function(e){return new(e||a)(t.LFG(f.rm),t.LFG(f.c9))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"});var v=r(6943),y=r(6895),p=r(433),P=r(2366),T=r(3289);const _=["categoryRef"];function x(c,e){if(1&c&&t._uU(0),2&c){const o=e.$implicit,n=t.oxw();t.Oqu(n._cs.doc(o.category).name)}}function M(c,e){if(1&c&&(t.TgZ(0,"option",6),t._uU(1),t.qZA()),2&c){const o=e.$implicit;t.Q6J("value",o._id),t.xp6(1),t.Oqu(o.name)}}function G(c,e){if(1&c){const o=t.EpF();t.TgZ(0,"span",3),t._uU(1,"Category"),t.qZA(),t.TgZ(2,"select",4),t.NdJ("ngModelChange",function(s){const d=t.CHM(o).$implicit;return t.KtG(d.component.set=s)})("ngModelChange",function(s){const d=t.CHM(o).$implicit,b=t.oxw();return t.KtG(b.setValue(d.form,"category",s))}),t.YNc(3,M,2,2,"option",5),t.qZA()}if(2&c){const o=e.$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngModel",o.component.set),t.xp6(1),t.Q6J("ngForOf",n._cs.categorys)}}class u{constructor(e,o,n){this._form=e,this._ps=o,this._cs=n,this.columns=["name","description","price","characteristics","category"],this.config={create:()=>{this.form.components[0].set="",this.form.components[1].set="",this.form.components[2].set="",this.form.components[3].set="",this.form.components[4].set="",this.form.components[5].label="Create",this._form.modal(this.form,s=>{console.log(s),console.log(this.form.components[4].set),this._ps.create(s)})},update:s=>{this.form.components[0].set=s.name,this.form.components[1].set=s.description,this.form.components[2].label=s.price,this.form.components[3].label=s.characteristics,this.form.components[4].set="",this.form.components[5].label="Update",this._form.modal(this.form,m=>{console.log(this.form.components[4].set),s.name=m.name,s.description=m.description,s.price=m.price,s.characteristics=m.characteristics,this._ps.save(s)})},delete:s=>{this._ps.delete(s)}}}ngOnInit(){this.form={components:[{module:i.xG.INPUT,placeholder:"name",label:"Name",input:"name",focused:!0},{module:i.xG.INPUT,placeholder:"description",label:"Description",input:"description"},{module:i.xG.INPUT,placeholder:"price",label:"Price",input:"price"},{module:i.xG.INPUT,placeholder:"characteristics",label:"Characteristics",input:"characteristics"},{module:i.xG.SELECT,customRef:this.categoryRef,label:"Category",input:"category"},{module:i.xG.BUTTON,type:C.q.PRIMARY}]}}setValue(e,o,n){e.get(o)?.setValue(n)}get rows(){return this._ps.products}}u.\u0275fac=function(e){return new(e||u)(t.Y36(i.oL),t.Y36(a),t.Y36(v.H))},u.\u0275cmp=t.Xpm({type:u,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&t.Gf(_,7),2&e){let n;t.iGM(n=t.CRH())&&(o.categoryRef=n.first)}},decls:4,vars:3,consts:[["title","Products",3,"columns","config","rows"],["cell","category"],["categoryRef",""],[1,"w-forms__title"],[1,"prod-field","category-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,o){1&e&&(t.TgZ(0,"wtable",0),t.YNc(1,x,1,1,"ng-template",1),t.qZA(),t.YNc(2,G,4,2,"ng-template",null,2,t.W1O)),2&e&&t.Q6J("columns",o.columns)("config",o.config)("rows",o.rows)},dependencies:[y.sg,p.YN,p.Kr,p.EJ,p.JJ,p.On,P.a,T.Y0]});var N=r(2887);const Y=[{path:"",component:u}];class l{}l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[N.Bz.forChild(Y),g.IR]})}}]);